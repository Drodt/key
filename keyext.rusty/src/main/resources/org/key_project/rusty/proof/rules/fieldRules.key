\sorts {
    \generic H;
    \generic E, E1, E2;
}

\rules {
    get_of_set {
        \schemaVar \term any x;
        \schemaVar \term Field<[E1]> f1;
        \schemaVar \term Field<[E2]> f2;
        \schemaVar \term E1 e;

        \find(get<[H, E1]>(set<[H, E2]>(x, f1, e), f2))
        \replacewith(\if (f1 = f2) \then (e) \else (get<[H, E1]>(x, f2)))
    };
}
