\schemaVariables {
    \term int left, right, i, i0, i1;
    \term numbers iz, jz;
}

\rules {
    // == u8 ==
    replace_u8_MIN {
        \find(u8_MIN)
        \replacewith(0)
        \heuristics(concrete)
    };

    replace_u8_MAX {
        \find(u8_MAX)
        \replacewith(255)
        \heuristics(concrete)
    };

    expand_in_u8 {
        \find(in_u8(i))
        \replacewith(leq(u8_MIN, i) & leq(i, u8_MAX))
        \heuristics(concrete)
    };

    // == u16 ==
    replace_u16_MIN {
        \find(u16_MIN)
        \replacewith(0)
        \heuristics(concrete)
    };

    replace_u16_MAX {
        \find(u16_MAX)
        \replacewith(65535)
        \heuristics(concrete)
    };

    expand_in_u16 {
        \find(in_u16(i))
        \replacewith(leq(u16_MIN, i) & leq(i, u16_MAX))
        \heuristics(concrete)
    };

    // == u32 ==
    replace_u32_MIN {
        \find(u32_MIN)
        \replacewith(0)
        \heuristics(concrete)
    };

    replace_u32_MAX {
        \find(u32_MAX)
        \replacewith(4294967295)
        \heuristics(concrete)
    };

    expand_in_u32 {
        \find(in_u32(i))
        \replacewith(leq(u32_MIN, i) & leq(i, u32_MAX))
        \heuristics(concrete)
    };

    // == u64 ==
    replace_u64_MIN {
        \find(u64_MIN)
        \replacewith(0)
        \heuristics(concrete)
    };

    replace_u64_MAX {
        \find(u64_MAX)
        \replacewith(18446744073709551615)
        \heuristics(concrete)
    };

    expand_in_u64 {
        \find(in_u64(i))
        \replacewith(leq(u64_MIN, i) & leq(i, u64_MAX))
        \heuristics(concrete)
    };

    // == u128 ==
    replace_u128_MIN {
        \find(u128_MIN)
        \replacewith(0)
        \heuristics(concrete)
    };

    replace_u128_MAX {
        \find(u128_MAX)
        \replacewith(340282366920938463463374607431768211455)
        \heuristics(concrete)
    };

    expand_in_u128 {
        \find(in_u128(i))
        \replacewith(leq(u128_MIN, i) & leq(i, u128_MAX))
        \heuristics(concrete)
    };

    // == usize ==
    replace_usize_MIN {
        \find(usize_MIN)
        \replacewith(0)
        \heuristics(concrete)
    };

    expand_in_usize {
        \find(in_usize(i))
        \replacewith(leq(usize_MIN, i) & leq(i, usize_MAX))
        \heuristics(concrete)
    };

    // == i8 ==
    replace_i8_MIN {
        \find(i8_MIN)
        \replacewith(-128)
        \heuristics(concrete)
    };

    replace_i8_MAX {
        \find(i8_MAX)
        \replacewith(127)
        \heuristics(concrete)
    };

    expand_in_i8 {
        \find(in_i8(i))
        \replacewith(leq(i8_MIN, i) & leq(i, i8_MAX))
        \heuristics(concrete)
    };

    // == i16 ==
    replace_i16_MIN {
        \find(i16_MIN)
        \replacewith(-32768)
        \heuristics(concrete)
    };

    replace_i16_MAX {
        \find(i16_MAX)
        \replacewith(32767)
        \heuristics(concrete)
    };

    expand_in_i16 {
        \find(in_i16(i))
        \replacewith(leq(i16_MIN, i) & leq(i, i16_MAX))
        \heuristics(concrete)
    };

    // == i32 ==
    replace_i32_MIN {
        \find(i32_MIN)
        \replacewith(-2147483648)
        \heuristics(concrete)
    };

    replace_i32_MAX {
        \find(i32_MAX)
        \replacewith(2147483647)
        \heuristics(concrete)
    };

    expand_in_i32 {
        \find(in_i32(i))
        \replacewith(leq(i32_MIN, i) & leq(i, i32_MAX))
        \heuristics(concrete)
    };

    // == i64 ==
    replace_i64_MIN {
        \find(i64_MIN)
        \replacewith(-9223372036854775808)
        \heuristics(concrete)
    };

    replace_i64_MAX {
        \find(i64_MAX)
        \replacewith(9223372036854775807)
        \heuristics(concrete)
    };

    expand_in_i64 {
        \find(in_i64(i))
        \replacewith(leq(i64_MIN, i) & leq(i, i64_MAX))
        \heuristics(concrete)
    };

    // == i128 ==
    replace_i128_MIN {
        \find(i128_MIN)
        \replacewith(-170141183460469231731687303715884105728)
        \heuristics(concrete)
    };

    replace_i128_MAX {
        \find(i128_MAX)
        \replacewith(170141183460469231731687303715884105727)
        \heuristics(concrete)
    };

    expand_in_i128 {
        \find(in_i128(i))
        \replacewith(leq(i128_MIN, i) & leq(i, i128_MAX))
        \heuristics(concrete)
    };

    // == isize ==
    expand_in_isize {
        \find(in_isize(i))
        \replacewith(leq(isize_MIN, i) & leq(i, isize_MAX))
        \heuristics(concrete)
    };
}

\rules(architecture:A16) {
    // == usize ==
    replace_usize_MAX {
        \find(usize_MAX)
        \replacewith(65535)
        \heuristics(concrete)
    };

    // == isize ==
    replace_isize_MIN {
        \find(isize_MIN)
        \replacewith(-32768)
        \heuristics(concrete)
    };

    replace_isize_MAX {
        \find(i128_MAX)
        \replacewith(32767)
        \heuristics(concrete)
    };
}

\rules(architecture:A32) {
    // == usize ==
    replace_usize_MAX {
        \find(usize_MAX)
        \replacewith(4294967295)
        \heuristics(concrete)
    };

    // == isize ==
    replace_isize_MIN {
        \find(isize_MIN)
        \replacewith(-2147483648)
        \heuristics(concrete)
    };

    replace_isize_MAX {
        \find(i128_MAX)
        \replacewith(2147483647)
        \heuristics(concrete)
    };
}

\rules(architecture:A64) {
    // == usize ==
    replace_usize_MAX {
        \find(usize_MAX)
        \replacewith(18446744073709551615)
        \heuristics(concrete)
    };

    // == isize ==
    replace_isize_MIN {
        \find(isize_MIN)
        \replacewith(-9223372036854775808)
        \heuristics(concrete)
    };

    replace_isize_MAX {
        \find(i128_MAX)
        \replacewith(9223372036854775807)
        \heuristics(concrete)
    };
}
